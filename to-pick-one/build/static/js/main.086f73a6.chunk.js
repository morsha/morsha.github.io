(this["webpackJsonpto-pick-one"]=this["webpackJsonpto-pick-one"]||[]).push([[0],{62:function(e,t,c){},67:function(e,t,c){},68:function(e,t,c){},70:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c(0),r=c.n(a),s=c(21),i=c.n(s),u=c(13),o=c.n(u),l=(c(62),c(5)),j=c(17),d=c(3),b=c(12),O=c(15),f=c(9),m=c(24),p=c(6);function h(e){return Object(m.a)(e).sort((function(){return Math.random()-.5}))}function g(e,t){return e.reduce((function(e,c){if(!e){var n=c.images.findIndex((function(e){return e.id===t}));if(~n)return c.images[n]}return e}),null)}var v="GET_TEST_SET",x="SEND_SET_RESULT",S="SEND_FINAL_RESULT";function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{imageSets:[],resultImageSet:{id:"final",name:"final",images:[]},finalResult:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case v:return Object(f.a)(Object(f.a)({},e),{},{imageSets:t.testSet.imageSets.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{id:e.id,images:h(e.images)})}))});case x:var c=g(e.imageSets,t.imageId);return Object(f.a)(Object(f.a)({},e),{},{redirectTo:"/set/".concat(-1===t.nextImageSetId?"final":t.nextImageSetId),resultImageSet:Object(f.a)(Object(f.a)({},e.resultImageSet),{},{images:[].concat(Object(m.a)(e.resultImageSet.images),[c])})});case S:var n=g(e.imageSets,t.imageId);return Object(f.a)(Object(f.a)({},e),{},{redirectTo:"/completed",finalResult:n});default:return e}}var k="CREATE_USER";function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{userId:null},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case k:return Object(f.a)(Object(f.a)({},e),{},{userId:t.user.id});default:return e}}function E(e){var t=e.name,c=e.gender,n=e.age;return function(e){return e(Object(O.a)({},u.API_REQUEST,{types:[k],auth:!0,method:"POST",body:{name:t,gender:c,age:n},json:!0,entrypoint:"/user",onSuccess:function(){var t;e((t=1,function(e){return e(Object(O.a)({},u.API_REQUEST,{types:[v],auth:!0,method:"GET",entrypoint:"/testSet/".concat(t),onSuccess:function(t){var c=t.testSet.imageSets[0].id;e(Object(p.d)("/set/".concat(c)))}}))}))}}))}}var y=c.p+"static/media/background_left.87699ce1.png",R=c.p+"static/media/background_right.a9edc41f.png",N=c.p+"static/media/logo.89480371.png";c(67);function _(){var e=Object(a.useState)(""),t=Object(b.a)(e,2),c=t[0],r=t[1],s=Object(a.useState)(""),i=Object(b.a)(s,2),u=i[0],o=i[1],j=Object(a.useState)("male"),d=Object(b.a)(j,2),O=d[0],f=d[1],m=Object(l.d)();return Object(n.jsxs)("div",{className:"landing-page",children:[Object(n.jsx)("img",{src:y,alt:""}),Object(n.jsx)("img",{src:R,alt:""}),Object(n.jsxs)("div",{className:"input-row-wrapper",children:[Object(n.jsx)("img",{className:"logo",src:N,alt:""}),Object(n.jsxs)("div",{className:"input-row",children:[Object(n.jsx)("span",{className:"label",children:"name:"}),Object(n.jsx)("input",{type:"text",value:c,onChange:function(e){return r(e.target.value)},placeholder:"name"})]}),Object(n.jsxs)("div",{className:"input-row",children:[Object(n.jsx)("span",{className:"label",children:"age:"}),Object(n.jsx)("input",{type:"text",value:u,onChange:function(e){return o(e.target.value.replace(/[^0-9]/,""))},placeholder:"age"})]}),Object(n.jsxs)("div",{className:"input-row",children:[Object(n.jsx)("span",{className:"label",children:"gender:"}),Object(n.jsx)("select",{value:O,onChange:function(e){var t=e.target;return f(t.value)},children:["male","female"].map((function(e){return Object(n.jsx)("option",{value:e,children:e},e)}))})]}),Object(n.jsx)("button",{type:"button",onClick:function(){return m(E({name:c,age:u,gender:O}))},children:"Send"})]})]})}_.defaultProps={};var P=_;c(68);var A=function(){var e=Object(d.h)(),t=Object(d.g)(),c=Object(d.i)().setId,r=Object(a.useMemo)((function(){return"final"===c}),[c]),s=Object(l.e)((function(e){return r?e.Result.resultImageSet:e.Result.imageSets.find((function(e){return"".concat(e.id)===c}))||{}})),i=Object(l.e)((function(e){return e.User.userId}));return Object(a.useEffect)((function(){i||t.push("/")}),[i,t]),Object(n.jsxs)("div",{className:"image-set-ready-page",children:["final"===s.id?Object(n.jsx)("span",{children:"Final Round"}):Object(n.jsxs)("span",{children:["type:",s.name||"ERROR"]}),Object(n.jsx)("button",{type:"button",onClick:function(){return t.push("".concat(e.pathname,"/start"))},children:"START"})]})},C=c(31),w=c.n(C),U=c(36);c(70);function D(){var e,t,c=Object(d.i)().setId,r=Object(l.d)(),s="final"===c,i=Object(l.e)((function(e){return s?e.Result.resultImageSet:e.Result.imageSets.find((function(e){return"".concat(e.id)===c}))||{}})),o=Object(a.useState)(!0),j=Object(b.a)(o,2),f=j[0],m=j[1],h=Object(a.useMemo)((function(){return i.images||[]}),[i.images]),g=Object(a.useMemo)((function(){return"final"===i.id?"\u7e3d\u6c7a\u8cfd":i.name}),[i.id,i.name]),v=Object(a.useCallback)(function(){var e=Object(U.a)(w.a.mark((function e(t){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.map((function(e){return new Promise((function(t,c){var n=new Image;n.src=e,n.onload=t(),n.onerror=c()}))}));case 2:return c=e.sent,e.next=5,Promise.all(c);case 5:m(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(a.useEffect)((function(){v(h)}),[v,h]);var I=Object(a.useState)(1),k=Object(b.a)(I,2),T=k[0],E=k[1],y=Object(a.useState)(0),R=Object(b.a)(y,2),N=R[0],_=R[1],P=Object(a.useState)(1),A=Object(b.a)(P,2),C=A[0],D=A[1],H=Object(a.useState)(!1),M=Object(b.a)(H,2),F=M[0],L=M[1],Q=Object(a.useState)(!1),B=Object(b.a)(Q,2),G=B[0],K=B[1],W=Object(a.useState)(!1),z=Object(b.a)(W,2),J=z[0],Z=z[1],V=Object(l.e)((function(e){return e.User.userId})),q=Object(a.useCallback)((function(e){r(s?function(e,t){return function(c){return c(Object(O.a)({},u.API_REQUEST,{types:[S],auth:!0,method:"POST",body:{userId:e,imageId:t},json:!0,entrypoint:"/finalResult",dispatchPayload:{imageId:t},onSuccess:function(){c(Object(p.d)("/completed"))}}))}}(V,e):function(e,t,c){return function(n,a){return n(Object(O.a)({},u.API_REQUEST,{types:[x],auth:!0,method:"POST",body:{userId:e,imageId:c},json:!0,entrypoint:"/setResult",dispatchPayload:{imageId:c},onSuccess:function(){console.log("AAA");var e=a().Result.imageSets,c=e.findIndex((function(e){return"".concat(e.id)===t}));if(c+1>=e.length)n(Object(p.d)("/set/final"));else{var r=e[c+1].id;n(Object(p.d)("/set/".concat(r)))}}}))}}(V,c,e))}),[r,s,c,V]),X=Object(a.useCallback)((function(){if(!J)if(T===h.length-1){var e=h[N];q(e.id)}else Z(!0),L(!0),setTimeout((function(){D(T+1),E(T+1),setTimeout((function(){L(!1),setTimeout((function(){Z(!1)}),200)}),200)}),200)}),[J,T,h,N,q]),Y=Object(a.useCallback)((function(){if(!J)if(T===h.length-1){var e=h[C];q(e.id)}else Z(!0),K(!0),setTimeout((function(){_(T+1),E(T+1),setTimeout((function(){K(!1),setTimeout((function(){Z(!1)}),200)}),200)}),200)}),[T,J,h,C,q]);return f?null:Object(n.jsxs)("div",{className:"image-set-choose-page",children:[Object(n.jsx)("div",{className:"header",children:Object(n.jsx)("span",{children:"".concat(g,": ").concat(T,"/").concat(h.length-1)})}),Object(n.jsx)("div",{className:"click-block-wrapper",children:Object(n.jsx)("div",{className:"click-block-expander",children:Object(n.jsx)("div",{className:"click-block",onClick:X,style:{backgroundImage:"url(".concat(null===(e=h[N])||void 0===e?void 0:e.url,")"),opacity:G?0:1}})})}),Object(n.jsx)("div",{className:"click-block-wrapper right",children:Object(n.jsx)("div",{className:"click-block-expander",children:Object(n.jsx)("div",{className:"click-block",onClick:Y,style:{backgroundImage:"url(".concat(null===(t=h[C])||void 0===t?void 0:t.url,")"),opacity:F?0:1}})})})]})}D.defaultProps={};var H=D;var M=function(){var e=Object(l.d)(),t=Object(l.e)((function(e){return e.User.userId}));return Object(a.useEffect)((function(){t||e(Object(p.d)("/"))}),[e,t]),Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{path:"/set/:setId/start",children:Object(n.jsx)(H,{})}),Object(n.jsx)(d.b,{path:"/set/:setId",children:Object(n.jsx)(A,{})})]})};c(71);var F=function(){var e=Object(l.e)((function(e){return e.Result.finalResult}));return Object(n.jsxs)("div",{className:"completed-page",children:[Object(n.jsx)("span",{children:"Thank you"}),Object(n.jsx)("img",{src:e.url||"https://i.imgur.com/yizNBG6.jpg",alt:"result"}),Object(n.jsx)("span",{children:"Plz feel free to contact Akimo for feedbacks"}),Object(n.jsx)("a",{href:"https://dcard.slack.com/team/U8ZAM5ZFS",target:"_blank",rel:"noopener noreferrer",children:Object(n.jsx)("button",{children:"Her Slack Profile"})})]})},L=c(16),Q=c(14),B=c(37),G=c(38),K=c.n(G),W=function(e){return Object(Q.c)({Result:I,router:Object(L.b)(e),User:T})},z=c(34),J=c(8),Z=Object(J.a)();var V=Object(Q.e)(W(Z),{},Object(Q.d)(Object(Q.a)(Object(z.a)(Z),B.a,o.a,K.a)));var q=function(){return Object(n.jsx)(j.a,{children:Object(n.jsx)(l.a,{store:V,children:Object(n.jsx)(L.a,{history:Z,children:Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{path:"/completed",children:Object(n.jsx)(F,{})}),Object(n.jsx)(d.b,{path:"/set",children:Object(n.jsx)(M,{})}),Object(n.jsx)(d.b,{path:"/",children:Object(n.jsx)(P,{})}),Object(n.jsx)(d.a,{to:"/"})]})})})})};Object(u.setAPIHost)(Object({NODE_ENV:"production",PUBLIC_URL:"/to-pick-one",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_HOST||"http://localhost:9000"),i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(q,{})}),document.getElementById("root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.086f73a6.chunk.js.map