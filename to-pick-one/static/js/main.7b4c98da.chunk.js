(this["webpackJsonpto-pick-one"]=this["webpackJsonpto-pick-one"]||[]).push([[0],{65:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n.n(a),s=n(21),i=n.n(s),u=n(13),o=n.n(u),l=(n(65),n(5)),j=n(17),d=n(4),b=n(12),O=n(15),f=n(6),m=n(24),p=n(7);function g(e){return Object(m.a)(e).sort((function(){return Math.random()-.5}))}function h(e,t){return e.reduce((function(e,n){if(!e){var c=n.images.findIndex((function(e){return e.id===t}));if(~c)return n.images[c]}return e}),null)}var x="RESULT/SET_LOADING",v="RESULT/GET_TEST_SET",S="RESULT/SEND_SET_RESULT",k="RESULT/SEND_FINAL_RESULT";function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{imageSets:[],resultImageSet:{id:"final",name:"final",images:[]},finalResult:{},loading:!1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case x:return Object(f.a)(Object(f.a)({},e),{},{loading:!0});case v:return Object(f.a)(Object(f.a)({},e),{},{imageSets:t.testSet.imageSets.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{id:e.id,images:g(e.images)})}))});case S:var n=h(e.imageSets,t.imageId);return Object(f.a)(Object(f.a)({},e),{},{redirectTo:"/set/".concat(-1===t.nextImageSetId?"final":t.nextImageSetId),resultImageSet:Object(f.a)(Object(f.a)({},e.resultImageSet),{},{images:[].concat(Object(m.a)(e.resultImageSet.images),[n])}),loading:!1});case k:var c=h(e.imageSets,t.imageId);return Object(f.a)(Object(f.a)({},e),{},{redirectTo:"/completed",finalResult:c,loading:!1});default:return e}}function y(){return{type:x}}var T="USER/SET_LOADING",E="USER/CREATE_USER";function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{userId:null,loading:!1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case T:return Object(f.a)(Object(f.a)({},e),{},{loading:!0});case E:return Object(f.a)(Object(f.a)({},e),{},{userId:t.user.id,loading:!1});default:return e}}function N(e){var t=e.name,n=e.gender,c=e.age;return function(e){return e(Object(O.a)({},u.API_REQUEST,{types:[E],auth:!0,method:"POST",body:{name:t,gender:n,age:c},json:!0,entrypoint:"/user",onSuccess:function(){var t;e((t=1,function(e){return e(Object(O.a)({},u.API_REQUEST,{types:[v],auth:!0,method:"GET",entrypoint:"/testSet/".concat(t),onSuccess:function(t){var n=t.testSet.imageSets[0].id;e(Object(p.d)("/set/".concat(n)))}}))}))}}))}}var w=n.p+"static/media/background_left.87699ce1.png",U=n.p+"static/media/background_right.a9edc41f.png",P=n.p+"static/media/logo.89480371.png",_=(n(70),{wrapper:{backgroundColor:"transparent"}});function C(e){var t=e.sm,n=e.black;return Object(c.jsx)("svg",{width:"".concat(t?"32px":"100%"),height:"".concat(t?"32px":"100%"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",style:_.wrapper,children:Object(c.jsx)("circle",{cx:"50",cy:"50",fill:"none",stroke:n?"#000":"#FFF",strokeWidth:"5",r:"35",strokeDasharray:"164.93361431346415 56.97787143782138",transform:"rotate(299.945 50 50)",children:Object(c.jsx)("animateTransform",{attributeName:"transform",type:"rotate",calcMode:"linear",values:"0 50 50;360 50 50",keyTimes:"0;1",dur:"1.2s",begin:"0s",repeatCount:"indefinite"})})})}C.defaultProps={sm:!1};var A=C;function L(){var e=Object(a.useState)(""),t=Object(b.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),i=Object(b.a)(s,2),u=i[0],o=i[1],j=Object(a.useState)("male"),d=Object(b.a)(j,2),O=d[0],f=d[1],m=Object(l.d)(),p=Object(l.e)((function(e){return e.User.loading}));return Object(c.jsxs)("div",{className:"landing-page",children:[Object(c.jsx)("img",{src:w,alt:""}),Object(c.jsx)("img",{src:U,alt:""}),Object(c.jsxs)("div",{className:"input-row-wrapper",children:[Object(c.jsx)("img",{className:"logo",src:P,alt:""}),Object(c.jsxs)("div",{className:"input-row",children:[Object(c.jsx)("span",{className:"label",children:"name:"}),Object(c.jsx)("input",{type:"text",value:n,onChange:function(e){return r(e.target.value)},placeholder:"name"})]}),Object(c.jsxs)("div",{className:"input-row",children:[Object(c.jsx)("span",{className:"label",children:"age:"}),Object(c.jsx)("input",{type:"text",value:u,onChange:function(e){return o(e.target.value.replace(/[^0-9]/,""))},placeholder:"age"})]}),Object(c.jsxs)("div",{className:"input-row",children:[Object(c.jsx)("span",{className:"label",children:"gender:"}),Object(c.jsx)("select",{value:O,onChange:function(e){var t=e.target;return f(t.value)},children:["male","female"].map((function(e){return Object(c.jsx)("option",{value:e,children:e},e)}))})]}),Object(c.jsx)("button",{type:"button",onClick:function(){m({type:T}),m(N({name:n,age:u,gender:O}))},children:p?Object(c.jsx)(A,{sm:!0}):"Send"})]})]})}L.defaultProps={};var M=L;n(71);var D=function(){var e=Object(d.h)(),t=Object(d.g)(),n=Object(d.i)().setId,r=Object(a.useMemo)((function(){return"final"===n}),[n]),s=Object(l.e)((function(e){return r?e.Result.resultImageSet:e.Result.imageSets.find((function(e){return"".concat(e.id)===n}))||{}})),i=Object(l.e)((function(e){return e.User.userId}));return Object(a.useEffect)((function(){i||t.push("/")}),[i,t]),Object(c.jsxs)("div",{className:"image-set-ready-page",children:["final"===s.id?Object(c.jsx)("span",{children:"Final Round"}):Object(c.jsxs)("span",{children:["type:",s.name||"ERROR"]}),Object(c.jsx)("button",{type:"button",onClick:function(){return t.push("".concat(e.pathname,"/start"))},children:"START"})]})},F=n(31),G=n.n(F),Q=n(36);n(73);function B(){var e,t,n=Object(d.i)().setId,r=Object(l.d)(),s="final"===n,i=Object(l.e)((function(e){return s?e.Result.resultImageSet:e.Result.imageSets.find((function(e){return"".concat(e.id)===n}))||{}})),o=Object(l.e)((function(e){return e.Result.loading})),j=Object(a.useState)(!0),f=Object(b.a)(j,2),m=f[0],g=f[1],h=Object(a.useMemo)((function(){return i.images||[]}),[i.images]),x=Object(a.useMemo)((function(){return"final"===i.id?"\u7e3d\u6c7a\u8cfd":i.name}),[i.id,i.name]),v=Object(a.useCallback)(function(){var e=Object(Q.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.map((function(e){return new Promise((function(t,n){var c=new Image;c.src=e,c.onload=t(),c.onerror=n()}))}));case 2:return n=e.sent,e.next=5,Promise.all(n);case 5:g(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(a.useEffect)((function(){v(h)}),[v,h]);var I=Object(a.useState)(1),T=Object(b.a)(I,2),E=T[0],R=T[1],N=Object(a.useState)(0),w=Object(b.a)(N,2),U=w[0],P=w[1],_=Object(a.useState)(1),C=Object(b.a)(_,2),L=C[0],M=C[1],D=Object(a.useState)(!1),F=Object(b.a)(D,2),B=F[0],z=F[1],H=Object(a.useState)(!1),J=Object(b.a)(H,2),V=J[0],Z=J[1],W=Object(a.useState)(!1),Y=Object(b.a)(W,2),q=Y[0],K=Y[1],X=Object(l.e)((function(e){return e.User.userId})),$=Object(a.useCallback)((function(e){s?(r(y()),r(function(e,t){return function(n){return n(Object(O.a)({},u.API_REQUEST,{types:[k],auth:!0,method:"POST",body:{userId:e,imageId:t},json:!0,entrypoint:"/finalResult",dispatchPayload:{imageId:t},onSuccess:function(){n(Object(p.d)("/completed"))}}))}}(X,e))):(r(y()),r(function(e,t,n){return function(c,a){return c(Object(O.a)({},u.API_REQUEST,{types:[S],auth:!0,method:"POST",body:{userId:e,imageId:n},json:!0,entrypoint:"/setResult",dispatchPayload:{imageId:n},onSuccess:function(){var e=a().Result.imageSets,n=e.findIndex((function(e){return"".concat(e.id)===t}));if(n+1>=e.length)c(Object(p.d)("/set/final"));else{var r=e[n+1].id;c(Object(p.d)("/set/".concat(r)))}}}))}}(X,n,e)))}),[r,s,n,X]),ee=Object(a.useCallback)((function(){if(!q&&!o)if(E===h.length-1){var e=h[U];$(e.id)}else K(!0),z(!0),setTimeout((function(){M(E+1),R(E+1),setTimeout((function(){z(!1),setTimeout((function(){K(!1)}),200)}),200)}),200)}),[q,o,E,h,U,$]),te=Object(a.useCallback)((function(){if(!q&&!o)if(E===h.length-1){var e=h[L];$(e.id)}else K(!0),Z(!0),setTimeout((function(){P(E+1),R(E+1),setTimeout((function(){Z(!1),setTimeout((function(){K(!1)}),200)}),200)}),200)}),[E,q,o,h,L,$]);return m?null:Object(c.jsxs)("div",{className:"image-set-choose-page",children:[Object(c.jsx)("div",{className:"header",children:Object(c.jsx)("span",{children:"".concat(x,": ").concat(E,"/").concat(h.length-1)})}),Object(c.jsx)("div",{className:"click-block-wrapper",children:Object(c.jsx)("div",{className:"click-block-expander",children:Object(c.jsx)("div",{className:"click-block",onClick:ee,style:{backgroundImage:"url(".concat(null===(e=h[U])||void 0===e?void 0:e.url,")"),opacity:V?0:1}})})}),Object(c.jsx)("div",{className:"click-block-wrapper right",children:Object(c.jsx)("div",{className:"click-block-expander",children:Object(c.jsx)("div",{className:"click-block",onClick:te,style:{backgroundImage:"url(".concat(null===(t=h[L])||void 0===t?void 0:t.url,")"),opacity:B?0:1}})})}),o?Object(c.jsx)("div",{className:"mask",children:Object(c.jsx)(A,{black:!0})}):null]})}B.defaultProps={};var z=B;var H=function(){var e=Object(l.d)(),t=Object(l.e)((function(e){return e.User.userId}));return Object(a.useEffect)((function(){t||e(Object(p.d)("/"))}),[e,t]),Object(c.jsxs)(d.d,{children:[Object(c.jsx)(d.b,{path:"/set/:setId/start",children:Object(c.jsx)(z,{})}),Object(c.jsx)(d.b,{path:"/set/:setId",children:Object(c.jsx)(D,{})})]})};n(74);var J=function(){var e=Object(l.e)((function(e){return e.Result.finalResult}));return Object(c.jsxs)("div",{className:"completed-page",children:[Object(c.jsx)("span",{children:"Thank you!"}),Object(c.jsx)("img",{src:e.url||"https://i.imgur.com/yizNBG6.jpg",alt:"result"}),Object(c.jsx)("span",{children:"Plz feel free to contact Akimo for feedbacks"}),Object(c.jsx)("a",{href:"https://dcard.slack.com/team/U8ZAM5ZFS",target:"_blank",rel:"noopener noreferrer",children:Object(c.jsx)("button",{children:"Her Slack Profile"})})]})},V=n(16),Z=n(14),W=n(37),Y=n(38),q=n.n(Y),K=function(e){return Object(Z.c)({Result:I,router:Object(V.b)(e),User:R})},X=n(34),$=n(9),ee=Object($.a)();var te=n(39),ne=Object(Z.e)(K(ee),{},Object(Z.d)(Object(Z.a)(Object(X.a)(ee),W.a,o.a,q.a)));var ce=function(){return Object(c.jsxs)(j.a,{children:[Object(c.jsx)(te.a,{videoId:"2t_SlySVgDg",opts:{height:"0",width:"0",playerVars:{autoplay:1}}}),Object(c.jsx)(l.a,{store:ne,children:Object(c.jsx)(V.a,{history:ee,children:Object(c.jsxs)(d.d,{children:[Object(c.jsx)(d.b,{path:"/completed",children:Object(c.jsx)(J,{})}),Object(c.jsx)(d.b,{path:"/set",children:Object(c.jsx)(H,{})}),Object(c.jsx)(d.b,{path:"/",children:Object(c.jsx)(M,{})}),Object(c.jsx)(d.a,{to:"/"})]})})})]})};Object(u.setAPIHost)("https://to-pick-one-server.herokuapp.com"),i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(ce,{})}),document.getElementById("root"))}},[[87,1,2]]]);
//# sourceMappingURL=main.7b4c98da.chunk.js.map