(this["webpackJsonpgithub-infinite-scroll"]=this["webpackJsonpgithub-infinite-scroll"]||[]).push([[0],{205:function(e,t,n){},206:function(e,t,n){},207:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(72),s=n.n(a),i=n(25),u=n(2),l=n(4),o=n(209),j=n(1);function b(){var e=Object(u.f)(),t=Object(u.g)().searchTerm,n=void 0===t?"":t,c=Object(r.useState)(n||""),a=Object(l.a)(c,2),s=a[0],i=a[1],b=Object(r.useState)(n||""),f=Object(l.a)(b,2),d=f[0],O=f[1],h=Object(o.a)(d,500),p=Object(l.a)(h,1)[0];return Object(r.useEffect)((function(){e.push("/".concat(p||""))}),[p,e]),Object(r.useEffect)((function(){i(n)}),[n]),Object(j.jsx)("div",{className:"header",children:Object(j.jsx)("input",{type:"text",className:"header__search-input",placeholder:"Input Search Words",value:s,onChange:function(e){i(e.target.value||""),O(e.target.value||"")}})})}var f=c.a.memo(b),d=c.a.forwardRef((function(e,t){var n,r=e.itemData;return Object(j.jsxs)("div",{ref:t,className:"infinite-scroll__item",children:[Object(j.jsx)("a",{className:"infinite-scroll__item__link",href:"".concat("https://github.com","/").concat(r.full_name),target:"_blank",rel:"noreferrer",children:r.name}),Object(j.jsx)("span",{className:"infinite-scroll__item__desc",children:r.description}),Object(j.jsxs)("div",{className:"infinite-scroll__item__remark-wrapper",children:[Object(j.jsxs)("div",{className:"infinite-scroll__item__remark",children:[Object(j.jsx)("i",{className:"fa fa-star"})," ",null===r||void 0===r?void 0:r.stargazers_count]}),Object(j.jsxs)("div",{className:"infinite-scroll__item__remark",children:[Object(j.jsx)("div",{className:"infinite-scroll__item__remark__circle-icon"}),null===r||void 0===r?void 0:r.language]}),Object(j.jsx)("div",{className:"infinite-scroll__item__remark",children:null===r||void 0===r||null===(n=r.license)||void 0===n?void 0:n.name})]})]})})),O=(n(88),function(e){var t=e.countDown,n=Object(r.useState)(t),c=Object(l.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){if(t){var e=setInterval((function(){s((function(e){return e-1}))}),1e3);return function(){clearInterval(e)}}return function(){return null}}),[t]),Object(j.jsxs)("div",{className:"loading-spinner-wrapper",children:[Object(j.jsx)("div",{className:"loading-spinner"}),a?Object(j.jsx)("span",{className:"loading-spinner__countdown",children:a}):null]})});O.defaultProps={countDown:0};var h=O;function p(e){var t=e.dataList,n=e.fetchMore,c=e.hasMore,a=e.error,s=e.loading,i=Object(r.useRef)(),u=Object(r.useCallback)((function(e){s||(i.current&&i.current.disconnect(),i.current=new IntersectionObserver((function(e){e[0].isIntersecting&&c&&!a&&n()})),e&&i.current.observe(e))}),[a,n,c,s]);return Object(j.jsxs)("div",{className:"infinite-scroll",children:[t.map((function(e){return Object(j.jsx)(d,{itemData:e},e.id)})),Object(j.jsx)("div",{className:"observer",ref:u}),s?Object(j.jsx)(h,{}):null]})}p.defaultProps={error:null};var m=c.a.memo(p),v=n(41),x=n(9),_=n.n(x),g=n(78),w=n(13),k=n(75),N=n.n(k),S=n(76),y=n.n(S),I=n(77),M=n.n(I),E="https://api.github.com";function C(){return(C=Object(w.a)(_.a.mark((function e(t){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M()({method:"GET",url:"".concat(E).concat(t)});case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),new Error("API Failed");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}var D=function(e){return C.apply(this,arguments)};var T=function(e,t){var n=Object(r.useRef)(),c=Object(r.useState)(!1),a=Object(l.a)(c,2),s=a[0],i=a[1],u=Object(r.useState)([]),o=Object(l.a)(u,2),j=o[0],b=o[1],f=Object(r.useState)(0),d=Object(l.a)(f,2),O=d[0],h=d[1],p=Object(r.useState)(null),m=Object(l.a)(p,2),x=m[0],k=m[1],S=Object(r.useState)(!0),I=Object(l.a)(S,2),M=I[0],E=I[1],C=Object(r.useState)(null),T=Object(l.a)(C,2),P=T[0],R=T[1],z=Object(r.useCallback)(function(){var n=Object(w.a)(_.a.mark((function n(r){var c,a;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c=N.a.stringify(Object(g.a)({q:t,per_page:30},r),{addQueryPrefix:!0}),n.next=4,D("".concat(e).concat(c));case 4:return(a=n.sent).items.length<30?E(!1):E(!0),n.abrupt("return",a);case 9:return n.prev=9,n.t0=n.catch(0),k(n.t0),n.abrupt("return",null);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}(),[t,e]),A=Object(r.useCallback)(Object(w.a)(_.a.mark((function e(){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(null),b([]),E(!0),t){e.next=5;break}return e.abrupt("return");case 5:return i(!0),e.next=8,z({page:1});case 8:(n=e.sent)&&(b(n.items),h(1)),i(!1);case 11:case"end":return e.stop()}}),e)}))),[z,t]),J=Object(r.useCallback)(Object(w.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M){e.next=2;break}return e.abrupt("return");case 2:return k(null),i(!0),e.next=6,z({page:O+1});case 6:(t=e.sent)&&t.items.length&&(n=y()([].concat(Object(v.a)(j),Object(v.a)(t.items)),(function(e){return e.id}))).length!==j.length&&(b(n),h((function(e){return e+1}))),i(!1);case 9:case"end":return e.stop()}}),e)}))),[j,z,M,O]),L=Object(r.useCallback)(Object(w.a)(_.a.mark((function e(){var t,r,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("/rate_limit");case 2:(t=e.sent)?(r=t.resources.search.reset,c=1e3*r-(new Date).valueOf()+1e3,R(parseInt(c/1e3,10)),n.current=setTimeout((function(){k(null),R(null)}),c)):(R(60),n.current=setTimeout((function(){k(null),R(null)}),6e4));case 4:case"end":return e.stop()}}),e)}))),[]);return Object(r.useEffect)((function(){return x&&L(),function(){n.current=null}}),[x,L]),[A,{data:j,loading:s,error:x,hasMore:M,fetchMore:J,retrySeconds:P}]};n(205);var P=function(){var e=Object(u.g)().searchTerm,t=T("/search/repositories",e),n=Object(l.a)(t,2),c=n[0],a=n[1],s=a.data,i=a.loading,o=a.error,b=a.hasMore,d=a.fetchMore,O=a.retrySeconds;return Object(r.useEffect)((function(){c()}),[c]),Object(j.jsxs)("main",{className:"main",children:[Object(j.jsx)(f,{}),e&&Object(j.jsx)(m,{dataList:s,fetchMore:d,hasMore:b,error:o,loading:i}),o&&O?Object(j.jsxs)("div",{className:"placeholder",children:["API limit is up, plz wait",Object(j.jsx)(h,{countDown:O})]}):null,b?null:Object(j.jsx)("p",{className:"placeholder",children:"No more data"})]})};var R=function(){return Object(j.jsx)(i.a,{basename:"/github-infinite-scroll",children:Object(j.jsxs)(u.c,{children:[Object(j.jsx)(u.a,{path:"/:searchTerm",children:Object(j.jsx)(P,{})}),Object(j.jsx)(u.a,{children:Object(j.jsx)(P,{})})]})})};n(206);s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(R,{})}),document.getElementById("root"))},88:function(e,t,n){},99:function(e,t){}},[[207,1,2]]]);
//# sourceMappingURL=main.ead5619f.chunk.js.map